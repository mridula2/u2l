#!/bin/sh
#
# ツール名 : 0009_binfile-del
# 概要	 : バイナリファイルを確認しながら削除する
# 実行方法 : 0009_binfile-del */binary_list.out
# 入力	 : */binary_list.out	: バイナリファイルリスト
# 出力	 : 削除しなかったファイルはcheck_list.outに出力する

yes_or_no(){
	echo "Delete? [ y or n]"
	read answer
	case $answer in
	y) return 0 ;;
	n) return 1 ;;
	*) echo "Please Input y or n."
		yes_or_no
		;;
	esac
}

# パラメータ確認
if [ $# -ne 1 ];
then
	echo "Usage : $0 filelist"
	exit 1
else
	filelist=$1
fi

# ファイルリストを確認
if [ -f $1 ];
then
	FILE=$1
else
	echo "Usage : $0 filelist"
	exit 1
fi

binary_list="binaryfile.list"
suffix=`basename $FILE`
if [ $suffix != $binary_list ];
then
	echo "File is not $binary_list"
	exit 1
fi

check_list="`dirname $FILE`/check.list"

for i in `cat $FILE`
do
	if [ -e $i ]; then
		echo ""
		head -v -n 1 $i
		yes_or_no
		if [ $? -eq 0 ];then
			rm -f $i
			echo "Deleted."
		else
			echo "$i" >> $check_list
		fi
	else
		echo "File Not Found. $i"
	fi
done
exit 0

