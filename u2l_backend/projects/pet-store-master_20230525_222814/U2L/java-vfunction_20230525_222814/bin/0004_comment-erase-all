#!/bin/sh
#
# $Header: /data/cvsrepo/assess-tools/bin/0004_comment-erase-all,v 1.6 2013/12/19 04:51:26 morimoto Exp $
# $Name: rev_1_10 $
#
# ツール名 : 0004_comment-erase-all
# 概要     : コメント除去ツールを呼び出すスクリプト
# 実行方法 : 0004_comment-erase-all [-s] FileList Dir
# 入力	   : FileList : ファイルリスト
#          : Dir      : 保存ディレクトリ名
#          : option s : スクリプトファイルに対して実行する場合指定
# 出力     : Dir ディレクトリ以下にコメント除去されたファイル

usage() {
	echo "Usage    : $0 [-s] FileList Destination_dir"
	echo "Option s : erese '#' comment."
	exit 1
}

option=""
while getopts s opt
do
	case ${opt} in
	s)
		option="-s";;
	\?)
		exit 1;;
	esac
done
shift `expr ${OPTIND} - 1`

if [ $# -ne 2 ];
then
	usage
fi

if [ -f $1 ];
then
	FILE=$1
else
	echo "Not found $1"
	exit 1
fi

if [ -d $2 ];
then
	DEST=$2
else
	echo "Not found $2"
	exit 1
fi
	
for i in `cat $FILE`
do
	bname=`basename $i`
	newdir=`dirname $i | sed 's/^\/[^/][^/]*\/src\/org\/[0-9][0-9]*\///'`
	mkdir -p $DEST/$newdir
	echo "Creating $DEST/$newdir/$bname"
	$PJHOME/bin/0005_comment-erase ${option} $i > $DEST/$newdir/$bname
	if [ $? -ne 0 ] ; then
		echo "	[Error] check $DEST/$newdir/$bname"
	fi
done
